{"ast":null,"code":"import React,{useState,useCallback}from'react';import{AutoComplete,Button,message}from'antd';import{SearchOutlined}from'@ant-design/icons';import{apiService}from'../services/api';import{debounce,handleApiError}from'../utils/helpers';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SearchBox=_ref=>{let{onSelectStock,placeholder=\"搜索股票代码或名称...\"}=_ref;const[options,setOptions]=useState([]);const[loading,setLoading]=useState(false);const[searchValue,setSearchValue]=useState('');// 搜索股票\nconst searchStocks=useCallback(debounce(async keyword=>{if(!keyword.trim()){setOptions([]);return;}setLoading(true);try{const response=await apiService.searchStocks(keyword,10);if(response.success&&response.data){const searchOptions=response.data.map(stock=>({value:`${stock.code} ${stock.name}`,label:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:500,color:'#ffffff'},children:stock.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'0.8rem',color:'#8b8d97'},children:[stock.code,\" | \\xA5\",stock.price.toFixed(2)]})]}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'right'},children:/*#__PURE__*/_jsxs(\"div\",{style:{color:stock.change_percent>0?'#22c55e':stock.change_percent<0?'#ef4444':'#8b8d97',fontSize:'0.8rem'},children:[stock.change_percent>0?'+':'',stock.change_percent.toFixed(2),\"%\"]})})]}),stock}));setOptions(searchOptions);}else{setOptions([]);}}catch(error){console.error('搜索失败:',error);message.error(handleApiError(error));setOptions([]);}finally{setLoading(false);}},300),[]);// 处理搜索输入\nconst handleSearch=value=>{setSearchValue(value);searchStocks(value);};// 处理选择\nconst handleSelect=(value,option)=>{onSelectStock(option.stock);setSearchValue('');setOptions([]);};// 处理搜索按钮点击\nconst handleSearchClick=()=>{if(searchValue.trim()){searchStocks(searchValue);}};// 处理键盘事件\nconst handleKeyPress=e=>{if(e.key==='Enter'){handleSearchClick();}};return/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-icon\",children:/*#__PURE__*/_jsx(SearchOutlined,{})}),/*#__PURE__*/_jsx(AutoComplete,{value:searchValue,options:options,onSearch:handleSearch,onSelect:handleSelect,onInputKeyDown:handleKeyPress,placeholder:placeholder,style:{width:320},dropdownStyle:{background:'#2a2d3a',border:'1px solid #3a3d4a',borderRadius:'8px'},notFoundContent:loading?'搜索中...':'暂无结果'}),/*#__PURE__*/_jsx(Button,{type:\"primary\",className:\"search-btn\",onClick:handleSearchClick,loading:loading,style:{position:'absolute',right:6,background:'#667eea',borderColor:'#667eea',borderRadius:'20px',padding:'8px 16px',fontSize:'0.85rem',fontWeight:500,zIndex:1},children:\"\\u641C\\u7D22\"})]});};export default SearchBox;","map":{"version":3,"names":["React","useState","useCallback","AutoComplete","Button","message","SearchOutlined","apiService","debounce","handleApiError","jsx","_jsx","jsxs","_jsxs","SearchBox","_ref","onSelectStock","placeholder","options","setOptions","loading","setLoading","searchValue","setSearchValue","searchStocks","keyword","trim","response","success","data","searchOptions","map","stock","value","code","name","label","style","display","justifyContent","alignItems","children","fontWeight","color","fontSize","price","toFixed","textAlign","change_percent","error","console","handleSearch","handleSelect","option","handleSearchClick","handleKeyPress","e","key","className","onSearch","onSelect","onInputKeyDown","width","dropdownStyle","background","border","borderRadius","notFoundContent","type","onClick","position","right","borderColor","padding","zIndex"],"sources":["E:/AICode/StockInsight/frontend/src/components/SearchBox.tsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { AutoComplete, Button, message } from 'antd';\nimport { SearchOutlined } from '@ant-design/icons';\nimport { apiService, SearchResult } from '../services/api';\nimport { debounce, handleApiError } from '../utils/helpers';\n\ninterface SearchBoxProps {\n  onSelectStock: (stock: SearchResult) => void;\n  placeholder?: string;\n}\n\ninterface OptionType {\n  value: string;\n  label: React.ReactNode;\n  stock: SearchResult;\n}\n\nconst SearchBox: React.FC<SearchBoxProps> = ({ \n  onSelectStock, \n  placeholder = \"搜索股票代码或名称...\" \n}) => {\n  const [options, setOptions] = useState<OptionType[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [searchValue, setSearchValue] = useState('');\n\n  // 搜索股票\n  const searchStocks = useCallback(\n    debounce(async (keyword: string) => {\n      if (!keyword.trim()) {\n        setOptions([]);\n        return;\n      }\n\n      setLoading(true);\n      try {\n        const response = await apiService.searchStocks(keyword, 10);\n        if (response.success && response.data) {\n          const searchOptions: OptionType[] = response.data.map(stock => ({\n            value: `${stock.code} ${stock.name}`,\n            label: (\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                <div>\n                  <div style={{ fontWeight: 500, color: '#ffffff' }}>{stock.name}</div>\n                  <div style={{ fontSize: '0.8rem', color: '#8b8d97' }}>\n                    {stock.code} | ¥{stock.price.toFixed(2)}\n                  </div>\n                </div>\n                <div style={{ textAlign: 'right' }}>\n                  <div style={{ \n                    color: stock.change_percent > 0 ? '#22c55e' : \n                           stock.change_percent < 0 ? '#ef4444' : '#8b8d97',\n                    fontSize: '0.8rem'\n                  }}>\n                    {stock.change_percent > 0 ? '+' : ''}{stock.change_percent.toFixed(2)}%\n                  </div>\n                </div>\n              </div>\n            ),\n            stock\n          }));\n          setOptions(searchOptions);\n        } else {\n          setOptions([]);\n        }\n      } catch (error) {\n        console.error('搜索失败:', error);\n        message.error(handleApiError(error));\n        setOptions([]);\n      } finally {\n        setLoading(false);\n      }\n    }, 300),\n    []\n  );\n\n  // 处理搜索输入\n  const handleSearch = (value: string) => {\n    setSearchValue(value);\n    searchStocks(value);\n  };\n\n  // 处理选择\n  const handleSelect = (value: string, option: OptionType) => {\n    onSelectStock(option.stock);\n    setSearchValue('');\n    setOptions([]);\n  };\n\n  // 处理搜索按钮点击\n  const handleSearchClick = () => {\n    if (searchValue.trim()) {\n      searchStocks(searchValue);\n    }\n  };\n\n  // 处理键盘事件\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      handleSearchClick();\n    }\n  };\n\n  return (\n    <div className=\"search-container\">\n      <div className=\"search-icon\">\n        <SearchOutlined />\n      </div>\n      <AutoComplete\n        value={searchValue}\n        options={options}\n        onSearch={handleSearch}\n        onSelect={handleSelect}\n        onInputKeyDown={handleKeyPress}\n        placeholder={placeholder}\n        style={{ width: 320 }}\n        dropdownStyle={{\n          background: '#2a2d3a',\n          border: '1px solid #3a3d4a',\n          borderRadius: '8px'\n        }}\n        notFoundContent={loading ? '搜索中...' : '暂无结果'}\n      />\n      <Button \n        type=\"primary\" \n        className=\"search-btn\"\n        onClick={handleSearchClick}\n        loading={loading}\n        style={{\n          position: 'absolute',\n          right: 6,\n          background: '#667eea',\n          borderColor: '#667eea',\n          borderRadius: '20px',\n          padding: '8px 16px',\n          fontSize: '0.85rem',\n          fontWeight: 500,\n          zIndex: 1\n        }}\n      >\n        搜索\n      </Button>\n    </div>\n  );\n};\n\nexport default SearchBox;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}