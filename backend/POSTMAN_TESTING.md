# Postman APIæµ‹è¯•æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•ä½¿ç”¨Postmanæµ‹è¯•è‚¡ç¥¨æ•°æ®APIçš„æ‰€æœ‰æ¥å£ã€‚

## ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### 1. å¯åŠ¨åç«¯æœåŠ¡

ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨å¹¶è¿è¡Œåœ¨ `http://localhost:5000`

```bash
cd backend
python run.py
```

### 2. å®‰è£…Postman

ä¸‹è½½å¹¶å®‰è£… [Postman](https://www.postman.com/downloads/)

### 3. åˆ›å»ºæ–°çš„Collection

åœ¨Postmanä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„Collectionï¼Œå‘½åä¸º "è‚¡ç¥¨æ•°æ®APIæµ‹è¯•"

## ğŸ§ª APIæ¥å£æµ‹è¯•

### 1. å¥åº·æ£€æŸ¥æ¥å£

**ç›®çš„**: éªŒè¯APIæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/health`
- **Headers**: æ— éœ€ç‰¹æ®Šè®¾ç½®

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": {
        "status": "healthy",
        "version": "1.0.0",
        "timestamp": 1703123456.789
    },
    "message": "è‚¡ç¥¨æ•°æ®APIæœåŠ¡æ­£å¸¸è¿è¡Œ"
}
```

**çŠ¶æ€ç **: 200 OK

---

### 2. è‚¡ç¥¨æœç´¢æ¥å£

**ç›®çš„**: æµ‹è¯•è‚¡ç¥¨æœç´¢åŠŸèƒ½

#### æµ‹è¯•ç”¨ä¾‹2.1: æŒ‰è‚¡ç¥¨åç§°æœç´¢

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/search`
- **Params**: 
  - `keyword`: `ä¸­è¿œæµ·æ§`
  - `limit`: `10` (å¯é€‰)

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": [
        {
            "code": "601919",
            "name": "ä¸­è¿œæµ·æ§",
            "price": 14.94,
            "change_percent": 4.69,
            "change_amount": 0.67,
            "volume": 12345678,
            "turnover": 184567890.12
        }
    ],
    "count": 1,
    "keyword": "ä¸­è¿œæµ·æ§"
}
```

#### æµ‹è¯•ç”¨ä¾‹2.2: æŒ‰è‚¡ç¥¨ä»£ç æœç´¢

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/search`
- **Params**: 
  - `keyword`: `601919`

#### æµ‹è¯•ç”¨ä¾‹2.3: æœç´¢å…³é”®è¯ä¸ºç©ºï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/search`
- **Params**: 
  - `keyword`: `` (ç©ºå­—ç¬¦ä¸²)

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "MISSING_KEYWORD",
    "error": "æœç´¢å…³é”®è¯ä¸èƒ½ä¸ºç©º"
}
```

**çŠ¶æ€ç **: 400 Bad Request

---

### 3. è‚¡ç¥¨è¯¦æƒ…æ¥å£

**ç›®çš„**: è·å–å•åªè‚¡ç¥¨çš„è¯¦ç»†ä¿¡æ¯

#### æµ‹è¯•ç”¨ä¾‹3.1: è·å–æœ‰æ•ˆè‚¡ç¥¨è¯¦æƒ…

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/601919`

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": {
        "code": "601919",
        "name": "ä¸­è¿œæµ·æ§",
        "price": 14.94,
        "change_percent": 4.69,
        "change_amount": 0.67,
        "volume": 12345678,
        "turnover": 184567890.12,
        "high": 15.20,
        "low": 14.50,
        "open": 14.80,
        "yesterday_close": 14.27,
        "market_cap": "2355äº¿",
        "pe_ratio": 4.69,
        "pb_ratio": 0.26,
        "roe": 17.82,
        "eps": 3.18,
        "bps": 57.42,
        "dividend_yield": 0.35,
        "is_watched": false,
        "timestamp": "2024-01-01T12:00:00"
    }
}
```

#### æµ‹è¯•ç”¨ä¾‹3.2: æ— æ•ˆè‚¡ç¥¨ä»£ç ï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/123456`

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "STOCK_NOT_FOUND",
    "error": "è‚¡ç¥¨ä¸å­˜åœ¨æˆ–æ•°æ®è·å–å¤±è´¥"
}
```

**çŠ¶æ€ç **: 404 Not Found

#### æµ‹è¯•ç”¨ä¾‹3.3: è‚¡ç¥¨ä»£ç æ ¼å¼é”™è¯¯ï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/abc123`

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "INVALID_STOCK_CODE",
    "error": "è‚¡ç¥¨ä»£ç æ ¼å¼é”™è¯¯"
}
```

**çŠ¶æ€ç **: 400 Bad Request

---

### 4. è‚¡ç¥¨å†å²æ•°æ®æ¥å£

**ç›®çš„**: è·å–è‚¡ç¥¨çš„å†å²ä»·æ ¼æ•°æ®

#### æµ‹è¯•ç”¨ä¾‹4.1: è·å–1ä¸ªæœˆå†å²æ•°æ®

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/601919/history`
- **Params**: 
  - `period`: `1m`

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": [
        {
            "date": "2024-01-01",
            "open": 14.50,
            "close": 14.80,
            "high": 15.00,
            "low": 14.30,
            "volume": 12345678,
            "turnover": 184567890.12,
            "change_percent": 2.07,
            "change_amount": 0.30
        }
    ],
    "count": 30,
    "period": "1m",
    "stock_code": "601919"
}
```

#### æµ‹è¯•ç”¨ä¾‹4.2: è·å–1å¹´å†å²æ•°æ®ï¼ˆé»˜è®¤ï¼‰

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/601919/history`
- **Params**: æ— ï¼ˆä½¿ç”¨é»˜è®¤period=1yï¼‰

#### æµ‹è¯•ç”¨ä¾‹4.3: æ— æ•ˆæ—¶é—´å‘¨æœŸï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stocks/601919/history`
- **Params**: 
  - `period`: `2y`

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "INVALID_PERIOD",
    "error": "æ—¶é—´å‘¨æœŸå‚æ•°é”™è¯¯ï¼Œæ”¯æŒçš„å‘¨æœŸ: 1d, 1w, 1m, 3m, 6m, 1y"
}
```

**çŠ¶æ€ç **: 400 Bad Request

---

### 5. æ‰¹é‡è·å–è‚¡ç¥¨æ•°æ®æ¥å£

**ç›®çš„**: ä¸€æ¬¡æ€§è·å–å¤šåªè‚¡ç¥¨çš„æ•°æ®

#### æµ‹è¯•ç”¨ä¾‹5.1: æ‰¹é‡è·å–æœ‰æ•ˆè‚¡ç¥¨

**é…ç½®**:
- **Method**: POST
- **URL**: `http://localhost:5000/api/stocks/batch`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw JSON):
```json
{
    "codes": ["601919", "600919", "000001"]
}
```

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": {
        "stocks": [
            {
                "code": "601919",
                "name": "ä¸­è¿œæµ·æ§",
                "price": 14.94,
                "change_percent": 4.69
            }
        ],
        "requested_count": 3,
        "valid_count": 3,
        "success_count": 1,
        "invalid_codes": []
    }
}
```

#### æµ‹è¯•ç”¨ä¾‹5.2: è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯ï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**:
- **Method**: POST
- **URL**: `http://localhost:5000/api/stocks/batch`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw JSON):
```json
{
    "stock_codes": ["601919"]
}
```

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "INVALID_REQUEST_DATA",
    "error": "è¯·æ±‚æ•°æ®æ ¼å¼é”™è¯¯ï¼Œéœ€è¦codeså­—æ®µ"
}
```

**çŠ¶æ€ç **: 400 Bad Request

#### æµ‹è¯•ç”¨ä¾‹5.3: è¶…è¿‡æ‰¹é‡é™åˆ¶ï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**:
- **Method**: POST
- **URL**: `http://localhost:5000/api/stocks/batch`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw JSON):
```json
{
    "codes": ["601919", "600919", "000001", "000002", "000004", "000005", "000006", "000007", "000008", "000009", "000010", "000011", "000012", "000013", "000014", "000015", "000016", "000017", "000018", "000019", "000020", "000021"]
}
```

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "TOO_MANY_CODES",
    "error": "ä¸€æ¬¡æœ€å¤šæŸ¥è¯¢20åªè‚¡ç¥¨"
}
```

**çŠ¶æ€ç **: 400 Bad Request

---

### 6. è·å–å…³æ³¨åˆ—è¡¨æ¥å£

**ç›®çš„**: è·å–ç”¨æˆ·çš„è‚¡ç¥¨å…³æ³¨åˆ—è¡¨

#### æµ‹è¯•ç”¨ä¾‹6.1: è·å–å…³æ³¨åˆ—è¡¨

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/watchlist`

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": [
        {
            "code": "601919",
            "name": "ä¸­è¿œæµ·æ§",
            "industry": "èˆªè¿æ¸¯å£",
            "added_time": "2024-01-01 12:00:00",
            "updated_time": "2024-01-01 12:00:00",
            "current_price": 14.94,
            "change_percent": 4.69,
            "change_amount": 0.67
        }
    ],
    "count": 1
}
```

---

### 7. æ·»åŠ è‚¡ç¥¨åˆ°å…³æ³¨åˆ—è¡¨æ¥å£

**ç›®çš„**: å°†è‚¡ç¥¨æ·»åŠ åˆ°å…³æ³¨åˆ—è¡¨

#### æµ‹è¯•ç”¨ä¾‹7.1: æ·»åŠ æœ‰æ•ˆè‚¡ç¥¨

**é…ç½®**:
- **Method**: POST
- **URL**: `http://localhost:5000/api/watchlist`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw JSON):
```json
{
    "code": "601919",
    "industry": "èˆªè¿æ¸¯å£"
}
```

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": {
        "code": "601919",
        "name": "ä¸­è¿œæµ·æ§",
        "industry": "èˆªè¿æ¸¯å£"
    },
    "message": "æ·»åŠ åˆ°å…³æ³¨åˆ—è¡¨æˆåŠŸ"
}
```

#### æµ‹è¯•ç”¨ä¾‹7.2: é‡å¤æ·»åŠ ï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**: ä¸7.1ç›¸åŒ

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "ALREADY_IN_WATCHLIST",
    "error": "è‚¡ç¥¨å·²åœ¨å…³æ³¨åˆ—è¡¨ä¸­"
}
```

**çŠ¶æ€ç **: 409 Conflict

#### æµ‹è¯•ç”¨ä¾‹7.3: æ·»åŠ ä¸å­˜åœ¨çš„è‚¡ç¥¨ï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**:
- **Method**: POST
- **URL**: `http://localhost:5000/api/watchlist`
- **Headers**: 
  - `Content-Type`: `application/json`
- **Body** (raw JSON):
```json
{
    "code": "999999",
    "industry": "æµ‹è¯•è¡Œä¸š"
}
```

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "STOCK_NOT_FOUND",
    "error": "è‚¡ç¥¨ä¸å­˜åœ¨æˆ–æ•°æ®è·å–å¤±è´¥"
}
```

**çŠ¶æ€ç **: 404 Not Found

---

### 8. åˆ é™¤å…³æ³¨çš„è‚¡ç¥¨æ¥å£

**ç›®çš„**: ä»å…³æ³¨åˆ—è¡¨ä¸­åˆ é™¤è‚¡ç¥¨

#### æµ‹è¯•ç”¨ä¾‹8.1: åˆ é™¤å­˜åœ¨çš„è‚¡ç¥¨

**é…ç½®**:
- **Method**: DELETE
- **URL**: `http://localhost:5000/api/watchlist/601919`

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": {
        "code": "601919"
    },
    "message": "ä»å…³æ³¨åˆ—è¡¨åˆ é™¤æˆåŠŸ"
}
```

#### æµ‹è¯•ç”¨ä¾‹8.2: åˆ é™¤ä¸å­˜åœ¨çš„è‚¡ç¥¨ï¼ˆé”™è¯¯æµ‹è¯•ï¼‰

**é…ç½®**:
- **Method**: DELETE
- **URL**: `http://localhost:5000/api/watchlist/999999`

**é¢„æœŸç»“æœ**:
```json
{
    "success": false,
    "error_code": "NOT_IN_WATCHLIST",
    "error": "è‚¡ç¥¨ä¸åœ¨å…³æ³¨åˆ—è¡¨ä¸­"
}
```

**çŠ¶æ€ç **: 404 Not Found

---

### 9. å¸‚åœºæ¦‚è§ˆæ¥å£

**ç›®çš„**: è·å–ä¸»è¦è‚¡æŒ‡çš„æ¦‚è§ˆä¿¡æ¯

#### æµ‹è¯•ç”¨ä¾‹9.1: è·å–å¸‚åœºæ¦‚è§ˆ

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/market/overview`

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": {
        "indices": {
            "ä¸Šè¯æŒ‡æ•°": {
                "code": "000001",
                "name": "ä¸Šè¯æŒ‡æ•°",
                "price": 3200.50,
                "change_percent": 1.25,
                "change_amount": 39.50
            },
            "æ·±è¯æˆæŒ‡": {
                "code": "399001",
                "name": "æ·±è¯æˆæŒ‡",
                "price": 11500.30,
                "change_percent": 0.85,
                "change_amount": 97.20
            },
            "åˆ›ä¸šæ¿æŒ‡": {
                "code": "399006",
                "name": "åˆ›ä¸šæ¿æŒ‡",
                "price": 2450.80,
                "change_percent": -0.45,
                "change_amount": -11.10
            }
        },
        "timestamp": "2024-01-01T12:00:00"
    }
}
```

---

### 10. ç®¡ç†æ¥å£æµ‹è¯•

#### æµ‹è¯•ç”¨ä¾‹10.1: æ¸…ç©ºç¼“å­˜

**é…ç½®**:
- **Method**: POST
- **URL**: `http://localhost:5000/api/cache/clear`

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": {
        "cleared": true
    },
    "message": "ç¼“å­˜æ¸…ç©ºæˆåŠŸ"
}
```

#### æµ‹è¯•ç”¨ä¾‹10.2: è·å–APIç»Ÿè®¡

**é…ç½®**:
- **Method**: GET
- **URL**: `http://localhost:5000/api/stats`
- **Params**: 
  - `hours`: `24`

**é¢„æœŸç»“æœ**:
```json
{
    "success": true,
    "data": {
        "api_stats": [
            {
                "endpoint": "api.search_stocks",
                "call_count": 15,
                "avg_response_time": 250.5,
                "error_count": 1,
                "success_rate": 93.33
            }
        ],
        "cache_stats": {
            "cache_size": 10,
            "cache_duration": 300
        },
        "period_hours": 24
    }
}
```

---

## ğŸ”„ æµ‹è¯•æµç¨‹å»ºè®®

### å®Œæ•´æµ‹è¯•æµç¨‹

1. **åŸºç¡€åŠŸèƒ½æµ‹è¯•**
   - å¥åº·æ£€æŸ¥ â†’ è‚¡ç¥¨æœç´¢ â†’ è‚¡ç¥¨è¯¦æƒ… â†’ å†å²æ•°æ®

2. **å…³æ³¨åˆ—è¡¨åŠŸèƒ½æµ‹è¯•**
   - è·å–ç©ºå…³æ³¨åˆ—è¡¨ â†’ æ·»åŠ è‚¡ç¥¨ â†’ è·å–å…³æ³¨åˆ—è¡¨ â†’ åˆ é™¤è‚¡ç¥¨

3. **æ‰¹é‡å’Œé«˜çº§åŠŸèƒ½æµ‹è¯•**
   - æ‰¹é‡è·å– â†’ å¸‚åœºæ¦‚è§ˆ â†’ ç®¡ç†æ¥å£

4. **é”™è¯¯å¤„ç†æµ‹è¯•**
   - æµ‹è¯•æ‰€æœ‰é”™è¯¯ç”¨ä¾‹ï¼ŒéªŒè¯é”™è¯¯å“åº”æ ¼å¼

### æ€§èƒ½æµ‹è¯•

1. **ç¼“å­˜æµ‹è¯•**
   - ç¬¬ä¸€æ¬¡è¯·æ±‚è®°å½•å“åº”æ—¶é—´
   - ç«‹å³é‡å¤è¯·æ±‚ï¼ŒéªŒè¯ç¼“å­˜ç”Ÿæ•ˆï¼ˆå“åº”æ›´å¿«ï¼‰

2. **é¢‘ç‡é™åˆ¶æµ‹è¯•**
   - å¿«é€Ÿè¿ç»­å‘é€è¶…è¿‡60ä¸ªè¯·æ±‚
   - éªŒè¯è¿”å›429çŠ¶æ€ç 

## ğŸ“Š æµ‹è¯•ç»“æœéªŒè¯

### æˆåŠŸæ ‡å‡†

- âœ… æ‰€æœ‰æ­£å¸¸ç”¨ä¾‹è¿”å›200çŠ¶æ€ç 
- âœ… å“åº”æ ¼å¼ç¬¦åˆAPIæ–‡æ¡£
- âœ… é”™è¯¯ç”¨ä¾‹è¿”å›æ­£ç¡®çš„é”™è¯¯ç å’ŒçŠ¶æ€ç 
- âœ… æ•°æ®å†…å®¹åˆç†ï¼ˆä»·æ ¼ã€ç™¾åˆ†æ¯”ç­‰ï¼‰
- âœ… ç¼“å­˜æœºåˆ¶æ­£å¸¸å·¥ä½œ
- âœ… å…³æ³¨åˆ—è¡¨å¢åˆ æ”¹æŸ¥åŠŸèƒ½æ­£å¸¸

### å¸¸è§é—®é¢˜æ’æŸ¥

1. **è¿æ¥å¤±è´¥**: æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
2. **æ•°æ®ä¸ºç©º**: æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAKShareæœåŠ¡çŠ¶æ€
3. **å“åº”æ…¢**: ç¬¬ä¸€æ¬¡è¯·æ±‚è¾ƒæ…¢æ˜¯æ­£å¸¸çš„ï¼Œåç»­æœ‰ç¼“å­˜
4. **è‚¡ç¥¨ä¸å­˜åœ¨**: ä½¿ç”¨çœŸå®å­˜åœ¨çš„è‚¡ç¥¨ä»£ç è¿›è¡Œæµ‹è¯•

---

**æµ‹è¯•å®Œæˆåï¼Œä½ åº”è¯¥å¯¹APIçš„æ‰€æœ‰åŠŸèƒ½éƒ½æœ‰äº†å…¨é¢çš„äº†è§£ï¼Œå¯ä»¥å¼€å§‹å‰ç«¯å¼€å‘æˆ–é›†æˆå·¥ä½œï¼**